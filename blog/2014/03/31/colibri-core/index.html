<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Efficiently modelling n-grams, skipgrams and flexgrams in large corpora with Colibri Core</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Efficiently modelling n-grams, skipgrams and flexgrams in large corpora with Colibri Core"/>
            <meta property="og:url" content="../../../../../blog/2014/03/31/colibri-core/"/>
            <meta property="og:description" content="Colibri Core is open-source software to quickly and efficiently count and extract patterns from large corpus data, to extract various statistics on the extracted patterns, and to compute relations between the extracted patterns. The software offers tools, that can be used from the command-line, as well as an API that can be used from Python scripts or C++ programs."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="../../../../../theme/css/bootstrap.min.css" type="text/css"/>
    <link href="../../../../../theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="../../../../../theme/css/bootstrap-glyphicons.css" rel="stylesheet">
    <link href="../../../../../theme/css/pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../../theme/css/style.css" type="text/css"/>
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://code.jquery.com/jquery.js"></script>

        <link href="../../../../../feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Contemplative Coding ATOM Feed"/>
        <link href="../../../../../feeds/all.rss.xml" type="application/atom+xml" rel="alternate"
              title="Contemplative Coding RSS Feed"/>

</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div id="logo"></div>
            <a href="../../../../.." class="navbar-brand"><strong>Contemplative Coding</strong></a>
            <span id="navbar-subtitle">Meditations on language & technology</span>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="http://proycon.anaproy.nl">About me</a></li>
                    <li><a href="http://github.com/proycon">My Code</a></li>
                    <li><a href="http://proycon.anaproy.nl/publications">Publications</a></li>
                        <li class="active">
                            <a href="../../../../../category/main.html">main</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="../../../../../archives.html"><i class="icon-th-list"></i>Archives</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="../../../../../blog/2014/03/31/colibri-core/"
                       rel="bookmark"
                       title="Permalink to Efficiently modelling n-grams, skipgrams and flexgrams in large corpora with Colibri Core">
                        Efficiently modelling n-grams, skipgrams and flexgrams in large corpora with Colibri Core
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="icon-calendar"></i>Mon 31 March 2014
    </span>



<span class="label label-default">Tags</span>
	<a href="../../../../../tag/ngrams.html">ngrams</a>
        /
	<a href="../../../../../tag/skipgrams.html">skipgrams</a>
        /
	<a href="../../../../../tag/python.html">python</a>
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>In this first actual blog post I would like to introduce open-source Natural Language
Processing software I developed in the scope of my PhD research at Radboud University Nijmegen: <strong>Colibri Core</strong>.</p>
<p>In this blog post I will merely illustrate the paradigm and the features of
Colibri Core, so you get a clear impression of the possibilities. For more I
refer to the aforementioned documentation.</p>
<div class="section" id="introduction">
<h2>Introduction</h2>
<p>Colibri Core is software to quickly and efficiently count and extract patterns from large corpus data, to extract various statistics on the extracted patterns, and to compute relations between the extracted patterns. The employed notion of <em>pattern</em> or <em>construction</em> encompasses the following categories:</p>
<ul class="simple">
<li><strong>n-gram</strong>    --    <em>n</em> consecutive words</li>
<li><strong>skipgram</strong>  --    An abstract pattern of predetermined length with one or multiple gaps (of
specific size).</li>
<li><strong>flexgram</strong>  --    An abstract pattern without predetermined length, with one
or more gaps.</li>
</ul>
<p>N-gram extraction may seem fairly trivial at first, with a few lines in your
favourite scripting language, you can move a simple sliding window of size <em>n</em>
over your corpus and store the results in some kind of hashmap. This trivial
approach however makes an unnecessarily high demand on memory resources, this
often becomes prohibitive if unleashed on large corpora. Colibri Core tries to minimise
these space requirements in several ways:</p>
<ul class="simple">
<li><strong>Binary representation</strong> --  Each word type is assigned a numeric class,
which is encoded in a compact binary format in which highly frequent classes take less space than less frequent classes. Colibri core always uses this representation rather than a full string representation, both on disk and in memory.</li>
<li><strong>Informed counting</strong> -- Counting is performed more intelligently by iteratively processing the corpus in several
passes and quickly discarding patterns that won't reach the desired occurrence threshold.</li>
</ul>
<p>Skipgram and flexgram extraction are computationally more demanding but have
been implemented with similar optimisations. Skipgrams are computed by
abstracting over n-grams, and flexgrams in turn are computed either by abstracting
over skipgrams, or directly from n-grams on the basis of co-occurrence information (mutual
pointwise information).</p>
</div>
<div class="section" id="pattern-models">
<h2>Pattern Models</h2>
<p>At the heart of the sofware is the notion of pattern models. The core tool, to
be used from the command-line, is <tt class="docutils literal"><span class="pre">colibri-patternmodeller</span></tt> which enables you to
build pattern models, generate statistical reports, query for specific patterns
and relations, and manipulate models.</p>
<p>A pattern model is simply a collection of extracted patterns (any of the three categories) and their counts from a
specific corpus. Pattern models come in two varieties:</p>
<ul class="simple">
<li><strong>Unindexed Pattern Model</strong> -- The simplest form, which simply stores the
patterns and their count.</li>
<li><strong>Indexed Pattern Model</strong> -- The more informed form, which retains all
indices to the original corpus, at the cost of more memory/diskspace.</li>
</ul>
<p>The Indexed Pattern Model is much more powerful, and allows more statistics and
relations to be inferred.</p>
<p>The generation of pattern models is optionally parametrised by a minimum occurrence
threshold, a maximum pattern length, and a lower-boundary on the different types
that may instantiate a skipgram (i.e. possible fillings of the gaps).</p>
<div class="section" id="statistics">
<h3>Statistics</h3>
<p>The statistics that are reported on are:</p>
<ul class="simple">
<li><strong>Occurrence count</strong> -- The absolute number of times a pattern occurs</li>
<li><strong>Tokens covered</strong> -- The absolute number of tokens in the corpus that a pattern covers. Computed as <tt class="docutils literal">occurrencecount * n</tt>.</li>
<li><strong>Coverage</strong> -- The number of covered tokens, as a fraction of the total number of tokens in the original corpus.</li>
<li><strong>Frequency</strong> -- The frequency of the pattern within its category and size class, so for an ngram of size two, the frequency indicates the frequency amongst all bigrams.</li>
<li><strong>Types</strong> -- The number of unique word types covered.</li>
</ul>
<p>These can be reported afer querying for specific patterns, or for groups (e.g.
all bigrams). For unindexed models, coverage computation is a mere
approximation. An example output report of a small pattern model from a tiny
toy corpus is shown below:</p>
<pre class="literal-block">
REPORT
----------------------------------
                            PATTERNS    TOKENS  COVERAGE     TYPES
Total:                             -       340         -       177
Uncovered:                         -       175    0.5147       136
Covered:                          69       165    0.4853        41

  CATEGORY N (SIZE)   PATTERNS    TOKENS  COVERAGE     TYPES OCCURRENCES
       all       all        69       165    0.4853        41         243
       all         1        40       165    0.4853        40         165
       all         2        11        26    0.0765        13          26
       all         3         7        17    0.0500         9          19
       all         4         5        10    0.0294         9          14
       all         5         5         9    0.0265         9          17
       all         6         1         2    0.0059         6           2
    n-gram       all        62       165    0.4853        40         215
    n-gram         1        40       165    0.4853        40         165
    n-gram         2        11        26    0.0765        13          26
    n-gram         3         5        12    0.0353         8          12
    n-gram         4         3         6    0.0176         6           6
    n-gram         5         2         4    0.0118         6           4
    n-gram         6         1         2    0.0059         6           2
  skipgram       all         7         7    0.0206         6          28
  skipgram         3         2         7    0.0206         4           7
  skipgram         4         2         4    0.0118         4           8
  skipgram         5         3         5    0.0147         5          13
</pre>
<p>Additionally, histograms can be generated and co-occurrence data between
patterns can be shown, which is computed using normalised pointwise mutual information.</p>
</div>
<div class="section" id="relations">
<h3>Relations</h3>
<p>Various relations can be extracted from patterns in an indexed pattern model:</p>
<ul class="simple">
<li><strong>Subsumption relations</strong> -- Patterns that are subsumed by larger patterns are called subsumption children, the larger patterns are called subsumption parents. These are the two subsumption relations that can be extracted from an indexed pattern model.</li>
<li><strong>Successor relations</strong> -- Patterns that follow eachother are in a left-of/right-of relation.</li>
<li><strong>Instantiation relations</strong> -- There is a relation between skipgrams and patterns that instantiate them: <tt class="docutils literal">to be {*1*} not {*1*} be</tt> is instantiated by <tt class="docutils literal">to {*1*} or</tt>.</li>
</ul>
<p>A web-based tool is available that allows these relations to be visualised and navigated interactively.</p>
</div>
<div class="section" id="manipulating-models">
<h3>Manipulating models</h3>
<p>Models can be actively manipulated by filtering and intersecting them with
other models. They can moreover be manipulated at a more finegrained level from
Python scripts using the available Python binding.</p>
<p>A very common application of intersecting models is when a first pattern model is
generated on a training corpus, and subsequently a second model is generated on
test data, but constrained using the training model. This results in a model
that contains only all patterns occurring both in training and test data, the
coverage metric of such a model thus provides a rough measure of overlap between corpora.</p>
</div>
</div>
<div class="section" id="implementation">
<h2>Implementation</h2>
<p>Colibri Core is entirely implemented in C++, to ensure efficiency with regard
to speed and memory. A full Python binding, directly interfacing with the native code,
is available, allowing you to load, query and manipulate Pattern Models from
Python scripts (version 3 is supported).</p>
<p>The software offers a powerful command-line tool, designed for Unix-based
systems such as Linux.</p>
<div class="section" id="download-documentation">
<h3>Download &amp; Documentation</h3>
<p>Everything is open-source (GPLv3) and can be obtained from:
<a class="reference external" href="http://github.com/proycon/colibri-core">http://github.com/proycon/colibri-core</a></p>
<p>Documentation is available from <a class="reference external" href="http://proycon.github.io/colibri-core/doc/">http://proycon.github.io/colibri-core/doc/</a> ,
which documents installation, usage as well as the Python API.</p>
</div>
<div class="section" id="under-the-hood">
<h3>Under the hood</h3>
<p>The API of Colibri Core offers an ideal foundation for building NLP software
that works on large numbers of patterns, and which seeks to constrain memory
usage and attaining high-performance.</p>
<p>In addition to offering a base class that holds a pattern, Colibri Core offers
a variety of containers (for C++ programmers; these behave like C++11 STL containers)
for storing patterns. The current storage backends are based on hashmaps or
ordered maps, but additional storage backends are envisioned for the future, such as
prefix tries/suffix tries or suffix arrays.</p>
<p>A schematic overview of the Colibri Core architecture is available below, consult the
documentation at <a class="reference external" href="http://proycon.github.io/colibri-core/doc/">http://proycon.github.io/colibri-core/doc/</a> for more details.</p>
<img alt="" src="http://proycon.github.io/colibri-core/doc/images/arch.png" />
</div>
</div>

            </div>
            <!-- /.entry-content -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'proytechblog'; // required: replace example with your forum shortname
            var disqus_identifier = 'colibri-core';
            var disqus_url = '../../../../../blog/2014/03/31/colibri-core/';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-lg-3 well well-sm" id="sidebar">
<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Social</h4></li>
                    <li class="list-group-item"><a href="http://github.com/proycon"><i
                            class="icon-github-sign icon-large"></i>github
                    </a></li>
                    <li class="list-group-item"><a href="http://twitter.com/proycon"><i
                            class="icon-twitter-sign icon-large"></i>twitter
                    </a></li>
                    <li class="list-group-item"><a href="http://youtube.com/proycon"><i
                            class="icon-youtube-sign icon-large"></i>youtube
                    </a></li>
                    <li class="list-group-item"><a href="http://facebook.com/proycon"><i
                            class="icon-facebook-sign icon-large"></i>facebook
                    </a></li>




            <li class="list-group-item"><a href="../../../../../tags.html"><h4><i class="icon-tags icon-large"></i>Tags</h4></a></li>
                <li class="list-group-item tag-4">
                    <a href="../../../../../tag/skipgrams.html">
                        skipgrams
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="../../../../../tag/python.html">
                        python
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="../../../../../tag/ngrams.html">
                        ngrams
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="../../../../../tag/intro.html">
                        intro
                    </a>
                </li>
        </ul>
    </section>


    <section>
    <ul class="list-group list-group-flush">
    <li class="list-group-item"><h4><i class="icon-github icon-large"></i>GitHub Repos</h4></li>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
            <a href="https://github.com/proycon">@proycon</a> on GitHub
    </ul>
        <script type="text/javascript">
            $(document).ready(function () {
                if (!window.jXHR) {
                    var jxhr = document.createElement('script');
                    jxhr.type = 'text/javascript';
                    jxhr.src = '../../../../../theme/js/jXHR.js';
                    var s = document.getElementsByTagName('script')[0];
                    s.parentNode.insertBefore(jxhr, s);
                }

                github.showRepos({
                    user: 'proycon',
                    count: 4,
                    skip_forks: true,
                    target: '#gh_repos'
                });
            });
        </script>
        <script src="../../../../../theme/js/github.js" type="text/javascript"></script>
    </section>
    <section>
                <li class="list-group-item"><h4><i class="icon-folder-open icon-large"></i>Blogroll</h4></li>
                    <li class="list-group-item-narrow"><a href="http://fbkarsdorp.github.io"><i
                            class="icon-circle-arrow-right icon-small"></i>Folgert Karsdorp
                    </a></li>
                    <li class="list-group-item-narrow"><a href="http://jeroenjanssens.com/"><i
                            class="icon-circle-arrow-right icon-small"></i>Jeroen Janssens
                    </a></li>
                    <li class="list-group-item-narrow"><a href="http://lingpipe-blog.com/"><i
                            class="icon-circle-arrow-right icon-small"></i>LingPipe Blog
                    </a></li>
                    <li class="list-group-item-narrow"><a href="http://mnmlist.com/"><i
                            class="icon-circle-arrow-right icon-small"></i>Mnmlist
                    </a></li>
                    <li class="list-group-item-narrow"><a href="http://jakevdp.github.io/"><i
                            class="icon-circle-arrow-right icon-small"></i>Pythonic Perambulations
                    </a></li>
                    <li class="list-group-item-narrow"><a href="http://tdotc.wordpress.com/"><i
                            class="icon-circle-arrow-right icon-small"></i>The dot on the ceiling
                    </a></li>
                    <li class="list-group-item-narrow"><a href="http://zenhabits.net"><i
                            class="icon-circle-arrow-right icon-small"></i>Zen Habits
                    </a></li>
    </section>
</aside>        </div>
    </div>
</div>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="../../../../../theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="../../../../../theme/js/respond.min.js"></script>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'proytechblog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>

<div id="footer">
    <strong>Contemplative Coding</strong> &ndash; <em>Meditations on Language &amp; Technology</em> &mdash; A research &amp; technology blog by <strong>Maarten van Gompel</strong> (<em>proycon</em>)
    <ul>
        <li>E-mail: <a href="mailto:proycon at anaproy dot nl">proycon at anaproy dot nl</a></li>
        <li>XMPP: proycon at anaproy dot nl</li>
        <li>IRC: proycon at freenode.org</li>
        <li>GnuPG key: 0x1A31555C</li>
    </ul>

</div>
</body>
</html>